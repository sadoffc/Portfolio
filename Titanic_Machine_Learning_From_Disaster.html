<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>















    






    
    
    
    

<div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">spark_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;SPARK_HOME&#39;</span><span class="p">]</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spark_path</span> <span class="o">+</span> <span class="s2">&quot;/bin&quot;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spark_path</span> <span class="o">+</span> <span class="s2">&quot;/python&quot;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spark_path</span> <span class="o">+</span> <span class="s2">&quot;/python/pyspark/&quot;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spark_path</span> <span class="o">+</span> <span class="s2">&quot;/python/lib&quot;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spark_path</span> <span class="o">+</span> <span class="s2">&quot;/python/lib/pyspark.zip&quot;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spark_path</span> <span class="o">+</span> <span class="s2">&quot;/python/lib/py4j-0.10.9-src.zip&quot;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">findspark</span>
<span class="n">findspark</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">pyspark</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">number_cores</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">memory_gb</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">conf</span> <span class="o">=</span> <span class="p">(</span><span class="n">pyspark</span><span class="o">.</span><span class="n">SparkConf</span><span class="p">()</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="s1">&#39;local[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number_cores</span><span class="p">))</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;spark.driver.memory&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">g&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">memory_gb</span><span class="p">)))</span>
<span class="n">sc</span> <span class="o">=</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">SparkContext</span><span class="p">(</span><span class="n">conf</span><span class="o">=</span><span class="n">conf</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">spark</span> <span class="o">=</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">SparkSession</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.mllib.regression</span> <span class="kn">import</span> <span class="n">LabeledPoint</span>
<span class="kn">from</span> <span class="nn">pyspark.mllib.classification</span> <span class="kn">import</span> <span class="n">SVMWithSGD</span>
<span class="kn">from</span> <span class="nn">pyspark.mllib.linalg</span> <span class="kn">import</span> <span class="n">SparseVector</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="s2">&quot;/users/connorsadoff/Desktop/train.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">train</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
<span class="n">train</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>root
 |-- PassengerId: integer (nullable = true)
 |-- Survived: integer (nullable = true)
 |-- Pclass: integer (nullable = true)
 |-- Name: string (nullable = true)
 |-- Sex: string (nullable = true)
 |-- Age: double (nullable = true)
 |-- SibSp: integer (nullable = true)
 |-- Parch: integer (nullable = true)
 |-- Ticket: string (nullable = true)
 |-- Fare: double (nullable = true)
 |-- Cabin: string (nullable = true)
 |-- Embarked: string (nullable = true)

</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[5]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[Row(PassengerId=1, Survived=0, Pclass=3, Name=&#39;Braund, Mr. Owen Harris&#39;, Sex=&#39;male&#39;, Age=22.0, SibSp=1, Parch=0, Ticket=&#39;A/5 21171&#39;, Fare=7.25, Cabin=None, Embarked=&#39;S&#39;)]</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="s2">&quot;/users/connorsadoff/Desktop/test.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inferSchema</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
<span class="n">test</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>root
 |-- PassengerId: integer (nullable = true)
 |-- Pclass: integer (nullable = true)
 |-- Name: string (nullable = true)
 |-- Sex: string (nullable = true)
 |-- Age: double (nullable = true)
 |-- SibSp: integer (nullable = true)
 |-- Parch: integer (nullable = true)
 |-- Ticket: string (nullable = true)
 |-- Fare: double (nullable = true)
 |-- Cabin: string (nullable = true)
 |-- Embarked: string (nullable = true)

</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[6]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[Row(PassengerId=892, Pclass=3, Name=&#39;Kelly, Mr. James&#39;, Sex=&#39;male&#39;, Age=34.5, SibSp=0, Parch=0, Ticket=&#39;330911&#39;, Fare=7.8292, Cabin=None, Embarked=&#39;Q&#39;)]</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.ml</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">pyspark.ml.feature</span> <span class="kn">import</span> <span class="n">StringIndexer</span>

<span class="n">indexers</span> <span class="o">=</span> <span class="p">[</span><span class="n">StringIndexer</span><span class="p">(</span><span class="n">inputCol</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">outputCol</span><span class="o">=</span><span class="n">column</span><span class="o">+</span><span class="s2">&quot;_index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Sex&quot;</span><span class="p">]]</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">indexers</span><span class="p">)</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">train</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>root
 |-- PassengerId: integer (nullable = true)
 |-- Survived: integer (nullable = true)
 |-- Pclass: integer (nullable = true)
 |-- Name: string (nullable = true)
 |-- Sex: string (nullable = true)
 |-- Age: double (nullable = true)
 |-- SibSp: integer (nullable = true)
 |-- Parch: integer (nullable = true)
 |-- Ticket: string (nullable = true)
 |-- Fare: double (nullable = true)
 |-- Cabin: string (nullable = true)
 |-- Embarked: string (nullable = true)
 |-- Sex_index: double (nullable = false)

</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Ticket&quot;</span><span class="p">,</span> <span class="s2">&quot;Cabin&quot;</span><span class="p">,</span> <span class="s2">&quot;Sex&quot;</span><span class="p">,</span> <span class="s2">&quot;Embarked&quot;</span><span class="p">)</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span>
<span class="nb">print</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>[&#39;PassengerId&#39;, &#39;Survived&#39;, &#39;Pclass&#39;, &#39;Age&#39;, &#39;SibSp&#39;, &#39;Parch&#39;, &#39;Fare&#39;, &#39;Sex_index&#39;]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[9]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cat_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PassengerID&#39;</span><span class="p">,</span> <span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex_index&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Parch&#39;</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[10]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cat_dictionary</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cat_columns</span><span class="p">:</span>
    <span class="n">unique_c</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
    <span class="c1">#print(c + &quot;: &quot; + str(len(unique_c)))</span>
    <span class="n">cat_dictionary</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">unique_c</span><span class="p">:</span>
        <span class="n">cat_dictionary</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">v</span><span class="p">[</span><span class="n">c</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[11]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cat_dictionary</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>{&#39;PassengerID&#39;: {148: 0, 463: 1, 471: 2, 496: 3, 833: 4, 243: 5, 392: 6, 540: 7, 623: 8, 737: 9, 858: 10, 31: 11, 516: 12, 85: 13, 137: 14, 251: 15, 451: 16, 580: 17, 808: 18, 65: 19, 458: 20, 879: 21, 883: 22, 53: 23, 255: 24, 481: 25, 588: 26, 799: 27, 804: 28, 133: 29, 296: 30, 472: 31, 853: 32, 78: 33, 322: 34, 513: 35, 321: 36, 362: 37, 613: 38, 633: 39, 673: 40, 857: 41, 375: 42, 593: 43, 597: 44, 876: 45, 108: 46, 155: 47, 683: 48, 744: 49, 34: 50, 193: 51, 211: 52, 368: 53, 530: 54, 642: 55, 796: 56, 101: 57, 115: 58, 126: 59, 756: 60, 772: 61, 81: 62, 385: 63, 830: 64, 847: 65, 874: 66, 28: 67, 183: 68, 210: 69, 436: 70, 497: 71, 596: 72, 762: 73, 300: 74, 406: 75, 412: 76, 784: 77, 787: 78, 842: 79, 587: 80, 731: 81, 76: 82, 667: 83, 688: 84, 723: 85, 26: 86, 27: 87, 332: 88, 501: 89, 577: 90, 626: 91, 384: 92, 831: 93, 44: 94, 159: 95, 192: 96, 271: 97, 606: 98, 743: 99, 811: 100, 844: 101, 253: 102, 806: 103, 103: 104, 236: 105, 329: 106, 460: 107, 12: 108, 336: 109, 350: 110, 223: 111, 738: 112, 860: 113, 388: 114, 417: 115, 548: 116, 602: 117, 91: 118, 409: 119, 578: 120, 663: 121, 333: 122, 707: 123, 822: 124, 222: 125, 285: 126, 601: 127, 875: 128, 22: 129, 128: 130, 209: 131, 330: 132, 372: 133, 604: 134, 685: 135, 727: 136, 122: 137, 230: 138, 319: 139, 493: 140, 625: 141, 686: 142, 93: 143, 157: 144, 190: 145, 225: 146, 232: 147, 233: 148, 758: 149, 246: 150, 346: 151, 360: 152, 367: 153, 476: 154, 539: 155, 599: 156, 725: 157, 855: 158, 861: 159, 111: 160, 224: 161, 519: 162, 654: 163, 47: 164, 140: 165, 177: 166, 416: 167, 556: 168, 711: 169, 827: 170, 132: 171, 152: 172, 444: 173, 665: 174, 671: 175, 185: 176, 305: 177, 353: 178, 355: 179, 618: 180, 694: 181, 696: 182, 747: 183, 882: 184, 291: 185, 325: 186, 386: 187, 435: 188, 473: 189, 581: 190, 603: 191, 660: 192, 748: 193, 774: 194, 146: 195, 704: 196, 259: 197, 512: 198, 797: 199, 1: 200, 206: 201, 52: 202, 297: 203, 363: 204, 768: 205, 770: 206, 777: 207, 212: 208, 674: 209, 715: 210, 274: 211, 631: 212, 182: 213, 442: 214, 689: 215, 699: 216, 792: 217, 13: 218, 218: 219, 280: 220, 348: 221, 440: 222, 734: 223, 6: 224, 16: 225, 86: 226, 474: 227, 636: 228, 760: 229, 168: 230, 205: 231, 572: 232, 852: 233, 887: 234, 3: 235, 142: 236, 178: 237, 308: 238, 328: 239, 867: 240, 20: 241, 40: 242, 164: 243, 429: 244, 470: 245, 839: 246, 169: 247, 500: 248, 139: 249, 283: 250, 359: 251, 479: 252, 295: 253, 340: 254, 431: 255, 692: 256, 881: 257, 94: 258, 250: 259, 377: 260, 402: 261, 432: 262, 582: 263, 57: 264, 570: 265, 868: 266, 647: 267, 292: 268, 306: 269, 339: 270, 676: 271, 54: 272, 120: 273, 559: 274, 491: 275, 634: 276, 646: 277, 96: 278, 235: 279, 545: 280, 620: 281, 776: 282, 846: 283, 871: 284, 452: 285, 732: 286, 840: 287, 48: 288, 266: 289, 507: 290, 544: 291, 650: 292, 5: 293, 163: 294, 191: 295, 268: 296, 258: 297, 279: 298, 709: 299, 729: 300, 19: 301, 397: 302, 430: 303, 754: 304, 92: 305, 419: 306, 542: 307, 553: 308, 560: 309, 836: 310, 415: 311, 780: 312, 257: 313, 299: 314, 641: 315, 644: 316, 826: 317, 64: 318, 117: 319, 227: 320, 579: 321, 504: 322, 554: 323, 598: 324, 764: 325, 886: 326, 41: 327, 154: 328, 309: 329, 425: 330, 347: 331, 447: 332, 455: 333, 484: 334, 607: 335, 15: 336, 43: 337, 845: 338, 262: 339, 511: 340, 112: 341, 269: 342, 327: 343, 563: 344, 615: 345, 849: 346, 165: 347, 666: 348, 775: 349, 358: 350, 366: 351, 843: 352, 854: 353, 179: 354, 189: 355, 207: 356, 489: 357, 590: 358, 675: 359, 862: 360, 37: 361, 383: 362, 659: 363, 61: 364, 127: 365, 316: 366, 461: 367, 502: 368, 523: 369, 819: 370, 88: 371, 197: 372, 486: 373, 531: 374, 318: 375, 462: 376, 547: 377, 107: 378, 202: 379, 263: 380, 374: 381, 564: 382, 619: 383, 891: 384, 9: 385, 17: 386, 231: 387, 552: 388, 324: 389, 586: 390, 609: 391, 72: 392, 286: 393, 398: 394, 505: 395, 538: 396, 175: 397, 387: 398, 423: 399, 695: 400, 746: 401, 381: 402, 498: 403, 721: 404, 850: 405, 35: 406, 503: 407, 583: 408, 594: 409, 610: 410, 614: 411, 761: 412, 880: 413, 677: 414, 739: 415, 310: 416, 485: 417, 568: 418, 698: 419, 742: 420, 838: 421, 870: 422, 196: 423, 437: 424, 456: 425, 829: 426, 834: 427, 217: 428, 290: 429, 441: 430, 733: 431, 800: 432, 884: 433, 229: 434, 307: 435, 326: 436, 537: 437, 766: 438, 823: 439, 114: 440, 173: 441, 220: 442, 278: 443, 301: 444, 494: 445, 669: 446, 713: 447, 810: 448, 813: 449, 890: 450, 4: 451, 55: 452, 59: 453, 445: 454, 684: 455, 8: 456, 100: 457, 241: 458, 449: 459, 450: 460, 495: 461, 717: 462, 757: 463, 161: 464, 555: 465, 687: 466, 23: 467, 39: 468, 679: 469, 719: 470, 49: 471, 176: 472, 380: 473, 520: 474, 629: 475, 672: 476, 736: 477, 791: 478, 7: 479, 162: 480, 514: 481, 549: 482, 637: 483, 877: 484, 130: 485, 238: 486, 244: 487, 446: 488, 624: 489, 648: 490, 84: 491, 136: 492, 453: 493, 720: 494, 856: 495, 247: 496, 314: 497, 627: 498, 664: 499, 691: 500, 728: 501, 824: 502, 87: 503, 565: 504, 649: 505, 171: 506, 273: 507, 343: 508, 434: 509, 439: 510, 443: 511, 585: 512, 51: 513, 194: 514, 277: 515, 331: 516, 428: 517, 465: 518, 794: 519, 391: 520, 438: 521, 532: 522, 706: 523, 821: 524, 69: 525, 129: 526, 166: 527, 448: 528, 467: 529, 97: 530, 400: 531, 543: 532, 524: 533, 533: 534, 661: 535, 693: 536, 234: 537, 239: 538, 264: 539, 312: 540, 389: 541, 869: 542, 63: 543, 635: 544, 885: 545, 395: 546, 403: 547, 779: 548, 459: 549, 509: 550, 10: 551, 77: 552, 102: 553, 361: 554, 589: 555, 814: 556, 848: 557, 658: 558, 50: 559, 518: 560, 750: 561, 771: 562, 267: 563, 293: 564, 404: 565, 527: 566, 817: 567, 45: 568, 569: 569, 769: 570, 793: 571, 216: 572, 759: 573, 812: 574, 38: 575, 261: 576, 320: 577, 418: 578, 82: 579, 181: 580, 249: 581, 364: 582, 510: 583, 167: 584, 288: 585, 394: 586, 576: 587, 703: 588, 80: 589, 240: 590, 289: 591, 356: 592, 889: 593, 25: 594, 73: 595, 245: 596, 427: 597, 591: 598, 763: 599, 816: 600, 113: 601, 237: 602, 645: 603, 795: 604, 24: 605, 160: 606, 818: 607, 70: 608, 408: 609, 62: 610, 121: 611, 125: 612, 396: 613, 730: 614, 156: 615, 351: 616, 480: 617, 143: 618, 219: 619, 697: 620, 95: 621, 411: 622, 477: 623, 482: 624, 740: 625, 29: 626, 226: 627, 390: 628, 651: 629, 741: 630, 789: 631, 464: 632, 526: 633, 528: 634, 558: 635, 21: 636, 214: 637, 653: 638, 710: 639, 323: 640, 550: 641, 335: 642, 338: 643, 352: 644, 492: 645, 798: 646, 866: 647, 98: 648, 195: 649, 256: 650, 678: 651, 714: 652, 287: 653, 345: 654, 490: 655, 595: 656, 752: 657, 767: 658, 790: 659, 828: 660, 809: 661, 863: 662, 32: 663, 60: 664, 90: 665, 371: 666, 622: 667, 75: 668, 382: 669, 469: 670, 621: 671, 630: 672, 786: 673, 203: 674, 221: 675, 265: 676, 457: 677, 640: 678, 662: 679, 782: 680, 835: 681, 141: 682, 151: 683, 341: 684, 414: 685, 433: 686, 608: 687, 712: 688, 724: 689, 859: 690, 334: 691, 592: 692, 751: 693, 801: 694, 145: 695, 200: 696, 272: 697, 376: 698, 488: 699, 515: 700, 680: 701, 735: 702, 56: 703, 109: 704, 254: 705, 378: 706, 487: 707, 639: 708, 213: 709, 228: 710, 478: 711, 534: 712, 655: 713, 303: 714, 426: 715, 574: 716, 718: 717, 749: 718, 170: 719, 354: 720, 702: 721, 708: 722, 807: 723, 304: 724, 536: 725, 611: 726, 612: 727, 668: 728, 783: 729, 105: 730, 298: 731, 370: 732, 753: 733, 865: 734, 58: 735, 188: 736, 726: 737, 837: 738, 11: 739, 33: 740, 204: 741, 421: 742, 575: 743, 781: 744, 872: 745, 888: 746, 83: 747, 110: 748, 150: 749, 369: 750, 413: 751, 508: 752, 541: 753, 825: 754, 68: 755, 71: 756, 106: 757, 260: 758, 567: 759, 525: 760, 561: 761, 116: 762, 147: 763, 14: 764, 198: 765, 317: 766, 546: 767, 600: 768, 638: 769, 805: 770, 344: 771, 349: 772, 424: 773, 657: 774, 123: 775, 342: 776, 373: 777, 379: 778, 454: 779, 832: 780, 158: 781, 199: 782, 242: 783, 270: 784, 284: 785, 690: 786, 135: 787, 248: 788, 499: 789, 522: 790, 42: 791, 119: 792, 337: 793, 466: 794, 506: 795, 566: 796, 2: 797, 79: 798, 201: 799, 765: 800, 778: 801, 803: 802, 131: 803, 149: 804, 276: 805, 365: 806, 773: 807, 820: 808, 294: 809, 357: 810, 529: 811, 118: 812, 573: 813, 722: 814, 124: 815, 281: 816, 571: 817, 30: 818, 99: 819, 184: 820, 302: 821, 313: 822, 652: 823, 815: 824, 66: 825, 405: 826, 557: 827, 682: 828, 700: 829, 46: 830, 67: 831, 186: 832, 275: 833, 282: 834, 605: 835, 802: 836, 311: 837, 535: 838, 873: 839, 616: 840, 628: 841, 632: 842, 681: 843, 174: 844, 215: 845, 410: 846, 172: 847, 562: 848, 716: 849, 864: 850, 252: 851, 399: 852, 551: 853, 144: 854, 153: 855, 420: 856, 705: 857, 785: 858, 851: 859, 670: 860, 745: 861, 18: 862, 475: 863, 74: 864, 138: 865, 755: 866, 104: 867, 180: 868, 468: 869, 483: 870, 643: 871, 656: 872, 134: 873, 584: 874, 841: 875, 878: 876, 407: 877, 521: 878, 788: 879, 617: 880, 701: 881, 36: 882, 187: 883, 208: 884, 315: 885, 393: 886, 89: 887, 401: 888, 422: 889, 517: 890}, &#39;Survived&#39;: {1: 0, 0: 1}, &#39;Sex_index&#39;: {0.0: 0, 1.0: 1}, &#39;Age&#39;: {8.0: 0, 70.0: 1, 7.0: 2, 20.5: 3, 49.0: 4, 29.0: 5, 40.5: 6, 64.0: 7, 47.0: 8, 42.0: 9, 24.5: 10, 44.0: 11, 35.0: 12, None: 13, 62.0: 14, 18.0: 15, 80.0: 16, 34.5: 17, 39.0: 18, 1.0: 19, 45.5: 20, 34.0: 21, 37.0: 22, 25.0: 23, 36.0: 24, 0.92: 25, 41.0: 26, 0.42: 27, 4.0: 28, 30.5: 29, 23.0: 30, 56.0: 31, 50.0: 32, 14.5: 33, 45.0: 34, 0.75: 35, 71.0: 36, 32.5: 37, 31.0: 38, 11.0: 39, 58.0: 40, 23.5: 41, 21.0: 42, 51.0: 43, 14.0: 44, 0.67: 45, 63.0: 46, 48.0: 47, 22.0: 48, 60.0: 49, 74.0: 50, 66.0: 51, 36.5: 52, 19.0: 53, 3.0: 54, 53.0: 55, 61.0: 56, 59.0: 57, 46.0: 58, 28.0: 59, 28.5: 60, 2.0: 61, 57.0: 62, 17.0: 63, 38.0: 64, 27.0: 65, 10.0: 66, 40.0: 67, 30.0: 68, 13.0: 69, 33.0: 70, 6.0: 71, 20.0: 72, 52.0: 73, 32.0: 74, 15.0: 75, 5.0: 76, 24.0: 77, 55.0: 78, 70.5: 79, 55.5: 80, 26.0: 81, 0.83: 82, 9.0: 83, 65.0: 84, 16.0: 85, 12.0: 86, 54.0: 87, 43.0: 88}, &#39;Parch&#39;: {1: 0, 6: 1, 3: 2, 5: 3, 4: 4, 2: 5, 0: 6}}
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[12]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">trainPrep</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;Survived&#39;</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">columns</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">c</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cat_columns</span><span class="p">:</span>
                <span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cat_dictionary</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">r</span><span class="p">[</span><span class="n">columns</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">c</span><span class="p">)]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">columns</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">c</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">LabeledPoint</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[13]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_clean</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">rdd</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">trainPrep</span><span class="p">)</span>
<span class="n">train_clean</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[13]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[LabeledPoint(0.0, [1.0,3.0,48.0,1.0,6.0,7.25,0.0]),
 LabeledPoint(1.0, [2.0,1.0,64.0,1.0,6.0,71.2833,1.0]),
 LabeledPoint(1.0, [3.0,3.0,81.0,0.0,6.0,7.925,1.0]),
 LabeledPoint(1.0, [4.0,1.0,12.0,1.0,6.0,53.1,1.0]),
 LabeledPoint(0.0, [5.0,3.0,12.0,0.0,6.0,8.05,0.0])]</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[14]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svm_titanic</span> <span class="o">=</span> <span class="n">SVMWithSGD</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">train_clean</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[15]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">indexers</span> <span class="o">=</span> <span class="p">[</span><span class="n">StringIndexer</span><span class="p">(</span><span class="n">inputCol</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">outputCol</span><span class="o">=</span><span class="n">column</span><span class="o">+</span><span class="s2">&quot;_index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Sex&quot;</span><span class="p">]]</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">indexers</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">test</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>root
 |-- PassengerId: integer (nullable = true)
 |-- Pclass: integer (nullable = true)
 |-- Name: string (nullable = true)
 |-- Sex: string (nullable = true)
 |-- Age: double (nullable = true)
 |-- SibSp: integer (nullable = true)
 |-- Parch: integer (nullable = true)
 |-- Ticket: string (nullable = true)
 |-- Fare: double (nullable = true)
 |-- Cabin: string (nullable = true)
 |-- Embarked: string (nullable = true)
 |-- Sex_index: double (nullable = false)

</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[16]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Ticket&quot;</span><span class="p">,</span> <span class="s2">&quot;Cabin&quot;</span><span class="p">,</span> <span class="s2">&quot;Sex&quot;</span><span class="p">,</span> <span class="s2">&quot;Embarked&quot;</span><span class="p">)</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">columns</span>
<span class="nb">print</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>[&#39;PassengerId&#39;, &#39;Pclass&#39;, &#39;Age&#39;, &#39;SibSp&#39;, &#39;Parch&#39;, &#39;Fare&#39;, &#39;Sex_index&#39;]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[17]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cat_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PassengerID&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex_index&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Parch&#39;</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[18]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cat_dictionary</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cat_columns</span><span class="p">:</span>
    <span class="n">unique_c</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
    <span class="c1">#print(c + &quot;: &quot; + str(len(unique_c)))</span>
    <span class="n">cat_dictionary</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">unique_c</span><span class="p">:</span>
        <span class="n">cat_dictionary</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">v</span><span class="p">[</span><span class="n">c</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[19]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cat_dictionary</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>{&#39;PassengerID&#39;: {1088: 0, 1238: 1, 897: 2, 1025: 3, 1084: 4, 1127: 5, 1139: 6, 1143: 7, 1270: 8, 1303: 9, 1265: 10, 1223: 11, 898: 12, 970: 13, 1157: 14, 918: 15, 1005: 16, 1016: 17, 1133: 18, 961: 19, 974: 20, 1160: 21, 976: 22, 1199: 23, 1212: 24, 950: 25, 1068: 26, 1198: 27, 1165: 28, 1183: 29, 939: 30, 1226: 31, 1259: 32, 1031: 33, 1175: 34, 1201: 35, 1051: 36, 1243: 37, 1274: 38, 1296: 39, 1030: 40, 1034: 41, 1064: 42, 1156: 43, 1163: 44, 988: 45, 1276: 46, 1307: 47, 914: 48, 1235: 49, 1019: 50, 1269: 51, 1294: 52, 908: 53, 916: 54, 1135: 55, 1148: 56, 1210: 57, 1280: 58, 1056: 59, 1085: 60, 973: 61, 984: 62, 1046: 63, 1093: 64, 1260: 65, 1208: 66, 926: 67, 1077: 68, 1215: 69, 1290: 70, 1249: 71, 995: 72, 1065: 73, 1125: 74, 1295: 75, 1176: 76, 1291: 77, 924: 78, 1061: 79, 1197: 80, 1207: 81, 1055: 82, 1244: 83, 1300: 84, 1114: 85, 1206: 86, 906: 87, 955: 88, 1288: 89, 1306: 90, 912: 91, 935: 92, 1170: 93, 1266: 94, 1122: 95, 1145: 96, 1247: 97, 1304: 98, 896: 99, 1008: 100, 1172: 101, 1302: 102, 992: 103, 1047: 104, 1190: 105, 1137: 106, 1089: 107, 1100: 108, 1155: 109, 1267: 110, 925: 111, 972: 112, 998: 113, 1062: 114, 1082: 115, 1218: 116, 1242: 117, 1130: 118, 1275: 119, 1171: 120, 1144: 121, 980: 122, 1021: 123, 1245: 124, 1273: 125, 1301: 126, 920: 127, 1026: 128, 966: 129, 1074: 130, 1113: 131, 919: 132, 923: 133, 944: 134, 983: 135, 1069: 136, 1146: 137, 1251: 138, 969: 139, 1028: 140, 1191: 141, 1029: 142, 1032: 143, 1167: 144, 1087: 145, 959: 146, 1010: 147, 1232: 148, 989: 149, 1192: 150, 1128: 151, 1227: 152, 1186: 153, 1250: 154, 1220: 155, 1222: 156, 1225: 157, 1299: 158, 936: 159, 1002: 160, 1048: 161, 1050: 162, 1166: 163, 1252: 164, 1255: 165, 1298: 166, 904: 167, 931: 168, 1181: 169, 1189: 170, 1035: 171, 1136: 172, 1151: 173, 1253: 174, 929: 175, 1052: 176, 1045: 177, 1194: 178, 1263: 179, 1091: 180, 1132: 181, 1182: 182, 1240: 183, 1286: 184, 1073: 185, 1119: 186, 1180: 187, 937: 188, 1231: 189, 903: 190, 979: 191, 993: 192, 1124: 193, 1216: 194, 1248: 195, 1271: 196, 1108: 197, 1158: 198, 1123: 199, 1219: 200, 1164: 201, 1293: 202, 1017: 203, 1211: 204, 1057: 205, 1159: 206, 1118: 207, 1121: 208, 1161: 209, 1072: 210, 1059: 211, 1142: 212, 900: 213, 1154: 214, 1272: 215, 948: 216, 986: 217, 960: 218, 1037: 219, 1096: 220, 1036: 221, 1205: 222, 930: 223, 987: 224, 1066: 225, 1256: 226, 1279: 227, 922: 228, 981: 229, 1015: 230, 1022: 231, 1060: 232, 1169: 233, 1254: 234, 1041: 235, 1075: 236, 1076: 237, 1111: 238, 1116: 239, 1287: 240, 958: 241, 1000: 242, 1236: 243, 1233: 244, 956: 245, 1195: 246, 1229: 247, 1305: 248, 957: 249, 994: 250, 1297: 251, 928: 252, 1200: 253, 1234: 254, 1001: 255, 1020: 256, 1230: 257, 1261: 258, 1006: 259, 1134: 260, 1058: 261, 1081: 262, 1209: 263, 982: 264, 1104: 265, 907: 266, 1094: 267, 1007: 268, 1098: 269, 951: 270, 1214: 271, 1102: 272, 938: 273, 977: 274, 952: 275, 1039: 276, 1110: 277, 946: 278, 945: 279, 1049: 280, 1147: 281, 895: 282, 1126: 283, 1213: 284, 893: 285, 1071: 286, 1078: 287, 1103: 288, 921: 289, 1003: 290, 967: 291, 1083: 292, 1099: 293, 968: 294, 1038: 295, 1221: 296, 1289: 297, 1177: 298, 1079: 299, 1153: 300, 1283: 301, 941: 302, 1179: 303, 1239: 304, 911: 305, 933: 306, 1042: 307, 1131: 308, 1140: 309, 1185: 310, 1257: 311, 1308: 312, 1168: 313, 1188: 314, 1173: 315, 990: 316, 1053: 317, 1150: 318, 1203: 319, 1284: 320, 1014: 321, 1115: 322, 1027: 323, 1282: 324, 1237: 325, 899: 326, 943: 327, 953: 328, 978: 329, 1023: 330, 1043: 331, 940: 332, 1040: 333, 997: 334, 1149: 335, 1105: 336, 1120: 337, 1281: 338, 1162: 339, 1196: 340, 1268: 341, 913: 342, 1024: 343, 1152: 344, 1033: 345, 1129: 346, 1241: 347, 910: 348, 1080: 349, 1224: 350, 1228: 351, 975: 352, 1184: 353, 1285: 354, 965: 355, 971: 356, 1018: 357, 1264: 358, 1086: 359, 902: 360, 1095: 361, 1106: 362, 909: 363, 1141: 364, 892: 365, 1262: 366, 962: 367, 1070: 368, 999: 369, 1092: 370, 905: 371, 1004: 372, 1187: 373, 1112: 374, 1011: 375, 1193: 376, 942: 377, 985: 378, 901: 379, 1090: 380, 1202: 381, 915: 382, 1012: 383, 1101: 384, 894: 385, 964: 386, 996: 387, 1178: 388, 1309: 389, 1054: 390, 1063: 391, 1067: 392, 1013: 393, 1109: 394, 1278: 395, 927: 396, 949: 397, 1174: 398, 947: 399, 1044: 400, 1246: 401, 1292: 402, 934: 403, 1097: 404, 1117: 405, 1204: 406, 1258: 407, 917: 408, 932: 409, 991: 410, 963: 411, 1009: 412, 1107: 413, 954: 414, 1217: 415, 1277: 416, 1138: 417}, &#39;Sex_index&#39;: {0.0: 0, 1.0: 1}, &#39;Age&#39;: {67.0: 0, 8.0: 1, 7.0: 2, 11.5: 3, 38.5: 4, 49.0: 5, 29.0: 6, 40.5: 7, 64.0: 8, 47.0: 9, 42.0: 10, 44.0: 11, 62.0: 12, None: 13, 35.0: 14, 18.0: 15, 34.5: 16, 39.0: 17, 1.0: 18, 18.5: 19, 37.0: 20, 34.0: 21, 25.0: 22, 36.0: 23, 0.92: 24, 41.0: 25, 22.5: 26, 23.0: 27, 50.0: 28, 14.5: 29, 45.0: 30, 0.75: 31, 32.5: 32, 31.0: 33, 58.0: 34, 21.0: 35, 51.0: 36, 14.0: 37, 63.0: 38, 48.0: 39, 22.0: 40, 60.0: 41, 36.5: 42, 53.0: 43, 19.0: 44, 3.0: 45, 61.0: 46, 59.0: 47, 46.0: 48, 28.0: 49, 28.5: 50, 2.0: 51, 57.0: 52, 17.0: 53, 0.17: 54, 60.5: 55, 38.0: 56, 27.0: 57, 10.0: 58, 26.5: 59, 30.0: 60, 40.0: 61, 13.0: 62, 0.33: 63, 33.0: 64, 6.0: 65, 20.0: 66, 32.0: 67, 24.0: 68, 15.0: 69, 5.0: 70, 55.0: 71, 26.0: 72, 9.0: 73, 0.83: 74, 16.0: 75, 12.0: 76, 54.0: 77, 76.0: 78, 43.0: 79}, &#39;Parch&#39;: {1: 0, 6: 1, 3: 2, 5: 3, 9: 4, 4: 5, 2: 6, 0: 7}}
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[20]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">testPrep</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
    <span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># passengerId</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>           
        <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cat_columns</span><span class="p">:</span>
            <span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cat_dictionary</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">r</span><span class="p">[</span><span class="n">columns</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">c</span><span class="p">)]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">columns</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">c</span><span class="p">)])</span>        
    <span class="k">return</span> <span class="n">LabeledPoint</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[21]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_clean</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">rdd</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">testPrep</span><span class="p">)</span>
<span class="n">test_clean</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[21]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[LabeledPoint(892.0, [892.0,3.0,16.0,0.0,7.0,7.8292,0.0]),
 LabeledPoint(893.0, [893.0,3.0,9.0,1.0,7.0,7.0,1.0]),
 LabeledPoint(894.0, [894.0,2.0,12.0,0.0,7.0,9.6875,0.0]),
 LabeledPoint(895.0, [895.0,3.0,57.0,0.0,7.0,8.6625,0.0]),
 LabeledPoint(896.0, [896.0,3.0,40.0,1.0,0.0,12.2875,1.0])]</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[22]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">testPrediction</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">svm_titanic</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">features</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">prediction</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[23]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_results</span> <span class="o">=</span> <span class="n">test_clean</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">testPrediction</span><span class="p">)</span><span class="o">.</span><span class="n">reduceByKey</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
<span class="n">df_results</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[23]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[(892.0, 0),
 (893.0, 0),
 (894.0, 0),
 (895.0, 0),
 (896.0, 0),
 (897.0, 0),
 (898.0, 0),
 (899.0, 0),
 (900.0, 0),
 (901.0, 0),
 (902.0, 0),
 (903.0, 0),
 (904.0, 0),
 (905.0, 0),
 (906.0, 0),
 (907.0, 0),
 (908.0, 0),
 (909.0, 0),
 (910.0, 0),
 (911.0, 0),
 (912.0, 0),
 (913.0, 0),
 (914.0, 0),
 (915.0, 0),
 (916.0, 1),
 (917.0, 0),
 (918.0, 0),
 (919.0, 0),
 (920.0, 0),
 (921.0, 0),
 (922.0, 0),
 (923.0, 0),
 (924.0, 0),
 (925.0, 0),
 (926.0, 0),
 (927.0, 0),
 (928.0, 0),
 (929.0, 0),
 (930.0, 0),
 (931.0, 0),
 (932.0, 0),
 (933.0, 0),
 (934.0, 0),
 (935.0, 0),
 (936.0, 0),
 (937.0, 0),
 (938.0, 0),
 (939.0, 0),
 (940.0, 0),
 (941.0, 0),
 (942.0, 0),
 (943.0, 0),
 (944.0, 0),
 (945.0, 1),
 (946.0, 0),
 (947.0, 0),
 (948.0, 0),
 (949.0, 0),
 (950.0, 0),
 (951.0, 1),
 (952.0, 0),
 (953.0, 0),
 (954.0, 0),
 (955.0, 0),
 (956.0, 1),
 (957.0, 0),
 (958.0, 0),
 (959.0, 0),
 (960.0, 0),
 (961.0, 1),
 (962.0, 0),
 (963.0, 0),
 (964.0, 0),
 (965.0, 0),
 (966.0, 1),
 (967.0, 1),
 (968.0, 0),
 (969.0, 0),
 (970.0, 0),
 (971.0, 0),
 (972.0, 0),
 (973.0, 1),
 (974.0, 0),
 (975.0, 0),
 (976.0, 0),
 (977.0, 0),
 (978.0, 0),
 (979.0, 0),
 (980.0, 0),
 (981.0, 0),
 (982.0, 0),
 (983.0, 0),
 (984.0, 0),
 (985.0, 0),
 (986.0, 0),
 (987.0, 0),
 (988.0, 0),
 (989.0, 0),
 (990.0, 0),
 (991.0, 0),
 (992.0, 0),
 (993.0, 0),
 (994.0, 0),
 (995.0, 0),
 (996.0, 0),
 (997.0, 0),
 (998.0, 0),
 (999.0, 0),
 (1000.0, 0),
 (1001.0, 0),
 (1002.0, 0),
 (1003.0, 0),
 (1004.0, 0),
 (1005.0, 0),
 (1006.0, 1),
 (1007.0, 0),
 (1008.0, 0),
 (1009.0, 0),
 (1010.0, 0),
 (1011.0, 0),
 (1012.0, 0),
 (1013.0, 0),
 (1014.0, 0),
 (1015.0, 0),
 (1016.0, 0),
 (1017.0, 0),
 (1018.0, 0),
 (1019.0, 0),
 (1020.0, 0),
 (1021.0, 0),
 (1022.0, 0),
 (1023.0, 0),
 (1024.0, 0),
 (1025.0, 0),
 (1026.0, 0),
 (1027.0, 0),
 (1028.0, 0),
 (1029.0, 0),
 (1030.0, 0),
 (1031.0, 0),
 (1032.0, 0),
 (1033.0, 1),
 (1034.0, 1),
 (1035.0, 0),
 (1036.0, 0),
 (1037.0, 0),
 (1038.0, 0),
 (1039.0, 0),
 (1040.0, 0),
 (1041.0, 0),
 (1042.0, 0),
 (1043.0, 0),
 (1044.0, 0),
 (1045.0, 0),
 (1046.0, 0),
 (1047.0, 0),
 (1048.0, 1),
 (1049.0, 0),
 (1050.0, 0),
 (1051.0, 0),
 (1052.0, 0),
 (1053.0, 0),
 (1054.0, 0),
 (1055.0, 0),
 (1056.0, 0),
 (1057.0, 0),
 (1058.0, 0),
 (1059.0, 0),
 (1060.0, 0),
 (1061.0, 0),
 (1062.0, 0),
 (1063.0, 0),
 (1064.0, 0),
 (1065.0, 0),
 (1066.0, 0),
 (1067.0, 0),
 (1068.0, 0),
 (1069.0, 0),
 (1070.0, 0),
 (1071.0, 0),
 (1072.0, 0),
 (1073.0, 0),
 (1074.0, 0),
 (1075.0, 0),
 (1076.0, 1),
 (1077.0, 0),
 (1078.0, 0),
 (1079.0, 0),
 (1080.0, 0),
 (1081.0, 0),
 (1082.0, 0),
 (1083.0, 0),
 (1084.0, 0),
 (1085.0, 0),
 (1086.0, 0),
 (1087.0, 0),
 (1088.0, 1),
 (1089.0, 0),
 (1090.0, 0),
 (1091.0, 0),
 (1092.0, 0),
 (1093.0, 0),
 (1094.0, 1),
 (1095.0, 0),
 (1096.0, 0),
 (1097.0, 0),
 (1098.0, 0),
 (1099.0, 0),
 (1100.0, 0),
 (1101.0, 0),
 (1102.0, 0),
 (1103.0, 0),
 (1104.0, 0),
 (1105.0, 0),
 (1106.0, 0),
 (1107.0, 0),
 (1108.0, 0),
 (1109.0, 1),
 (1110.0, 1),
 (1111.0, 0),
 (1112.0, 0),
 (1113.0, 0),
 (1114.0, 0),
 (1115.0, 0),
 (1116.0, 0),
 (1117.0, 0),
 (1118.0, 0),
 (1119.0, 0),
 (1120.0, 0),
 (1121.0, 0),
 (1122.0, 0),
 (1123.0, 0),
 (1124.0, 0),
 (1125.0, 0),
 (1126.0, 0),
 (1127.0, 0),
 (1128.0, 0),
 (1129.0, 0),
 (1130.0, 0),
 (1131.0, 1),
 (1132.0, 0),
 (1133.0, 0),
 (1134.0, 1),
 (1135.0, 0),
 (1136.0, 0),
 (1137.0, 0),
 (1138.0, 0),
 (1139.0, 0),
 (1140.0, 0),
 (1141.0, 0),
 (1142.0, 0),
 (1143.0, 0),
 (1144.0, 1),
 (1145.0, 0),
 (1146.0, 0),
 (1147.0, 0),
 (1148.0, 0),
 (1149.0, 0),
 (1150.0, 0),
 (1151.0, 0),
 (1152.0, 0),
 (1153.0, 0),
 (1154.0, 0),
 (1155.0, 0),
 (1156.0, 0),
 (1157.0, 0),
 (1158.0, 0),
 (1159.0, 0),
 (1160.0, 0),
 (1161.0, 0),
 (1162.0, 0),
 (1163.0, 0),
 (1164.0, 1),
 (1165.0, 0),
 (1166.0, 0),
 (1167.0, 0),
 (1168.0, 0),
 (1169.0, 0),
 (1170.0, 0),
 (1171.0, 0),
 (1172.0, 0),
 (1173.0, 0),
 (1174.0, 0),
 (1175.0, 0),
 (1176.0, 0),
 (1177.0, 0),
 (1178.0, 0),
 (1179.0, 0),
 (1180.0, 0),
 (1181.0, 0),
 (1182.0, 0),
 (1183.0, 0),
 (1184.0, 0),
 (1185.0, 0),
 (1186.0, 0),
 (1187.0, 0),
 (1188.0, 0),
 (1189.0, 0),
 (1190.0, 0),
 (1191.0, 0),
 (1192.0, 0),
 (1193.0, 0),
 (1194.0, 0),
 (1195.0, 0),
 (1196.0, 0),
 (1197.0, 0),
 (1198.0, 1),
 (1199.0, 0),
 (1200.0, 0),
 (1201.0, 0),
 (1202.0, 0),
 (1203.0, 0),
 (1204.0, 0),
 (1205.0, 0),
 (1206.0, 1),
 (1207.0, 0),
 (1208.0, 1),
 (1209.0, 0),
 (1210.0, 0),
 (1211.0, 0),
 (1212.0, 0),
 (1213.0, 0),
 (1214.0, 0),
 (1215.0, 0),
 (1216.0, 1),
 (1217.0, 0),
 (1218.0, 0),
 (1219.0, 0),
 (1220.0, 0),
 (1221.0, 0),
 (1222.0, 0),
 (1223.0, 0),
 (1224.0, 0),
 (1225.0, 0),
 (1226.0, 0),
 (1227.0, 0),
 (1228.0, 0),
 (1229.0, 0),
 (1230.0, 0),
 (1231.0, 0),
 (1232.0, 0),
 (1233.0, 0),
 (1234.0, 0),
 (1235.0, 1),
 (1236.0, 0),
 (1237.0, 0),
 (1238.0, 0),
 (1239.0, 0),
 (1240.0, 0),
 (1241.0, 0),
 (1242.0, 0),
 (1243.0, 0),
 (1244.0, 0),
 (1245.0, 0),
 (1246.0, 0),
 (1247.0, 0),
 (1248.0, 0),
 (1249.0, 0),
 (1250.0, 0),
 (1251.0, 0),
 (1252.0, 0),
 (1253.0, 0),
 (1254.0, 0),
 (1255.0, 0),
 (1256.0, 0),
 (1257.0, 0),
 (1258.0, 0),
 (1259.0, 0),
 (1260.0, 0),
 (1261.0, 0),
 (1262.0, 0),
 (1263.0, 1),
 (1264.0, 0),
 (1265.0, 0),
 (1266.0, 0),
 (1267.0, 1),
 (1268.0, 0),
 (1269.0, 0),
 (1270.0, 0),
 (1271.0, 0),
 (1272.0, 0),
 (1273.0, 0),
 (1274.0, 0),
 (1275.0, 0),
 (1276.0, 0),
 (1277.0, 0),
 (1278.0, 0),
 (1279.0, 0),
 (1280.0, 0),
 (1281.0, 0),
 (1282.0, 0),
 (1283.0, 0),
 (1284.0, 0),
 (1285.0, 0),
 (1286.0, 0),
 (1287.0, 0),
 (1288.0, 0),
 (1289.0, 0),
 (1290.0, 0),
 (1291.0, 0),
 (1292.0, 1),
 (1293.0, 0),
 (1294.0, 0),
 (1295.0, 0),
 (1296.0, 0),
 (1297.0, 0),
 (1298.0, 0),
 (1299.0, 1),
 (1300.0, 0),
 (1301.0, 0),
 (1302.0, 0),
 (1303.0, 0),
 (1304.0, 0),
 (1305.0, 0),
 (1306.0, 0),
 (1307.0, 0),
 (1308.0, 0),
 (1309.0, 0)]</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[24]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df_results</span><span class="o">.</span><span class="n">toDF</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[25]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">coalesce</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">write</span>\
    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;header&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;sep&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="s2">&quot;overwrite&quot;</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="s2">&quot;/users/connorsadoff/Desktop/titanic&quot;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>









<script type="text/javascript" src="/d2l/common/math/MathML.js?v=20.21.8.31636 "></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() { D2LMathML.DesktopInit('https://s.brightspace.com/lib/mathjax/2.7.4/MathJax.js?config=MML_HTMLorMML','https://s.brightspace.com/lib/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML','130',true); });</script></body></html>